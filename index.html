<html>
<head> </head>
<body>
<!-- FORM -->
<form id="lead-form">
  <label>First Name</label>
  <input type="text" name="firstname" required>

  <label>Last Name</label>
  <input type="text" name="lastname" required>

  <label>Email</label>
  <input type="email" name="email" required>

  <!-- Hidden UTM Fields -->
  <input type="hidden" name="gclid" id="gclid">
  <input type="hidden" name="utm_source" id="utm_source">
  <input type="hidden" name="utm_medium" id="utm_medium">
  <input type="hidden" name="utm_campaign" id="utm_campaign">

  <button type="submit">Submit</button>
</form>

<!-- SCRIPT TO CAPTURE UTM PARAMETERS -->
<script>
 function utmParameters() {
  var utmParameters = {};
  // Gets the query string, removes the '?', and splits by '&'
  var queryParameters = location.search.substring(1).split('&');

  for (var f = 0; f < queryParameters.length; f++) {
    // Splits the 'key=value' pair by '='
    var param = queryParameters[f].split('=');

    // **CORRECTED:** Using the proper 'startsWith' method
    if (param[0].startsWith('utm_')) {
      // Stores the parameter key and the decoded value
      utmParameters[param[0]] = decodeURIComponent(param[1]);
    }
  }

  // Returns the final object containing only UTM parameters
  return utmParameters;
}

// **USAGE EXAMPLE (What you would do outside the function):**
// 1. You would call the function to get the parameters.
// const myUtms = utmParameters();
// 2. If you needed to run this function after the document loads, you'd call it like this:
// document.addEventListener("DOMContentLoaded", function() {
//     const utm_data = utmParameters();
//     console.log(utm_data);
// });
</script>

</body>

</html>

